<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.best.test.dao.TestDao">

  <!-- CURD START -->
    <insert id="insert">
      <selectKey keyProperty="id" resultType="long" order="BEFORE">
        select TBL_TEST_SEQ.nextval from dual
      </selectKey>
      insert into TBL_TEST(
        <!-- 0 -->id,
        <!-- 1 -->cost_center,
        <!-- 2 -->cost_center_code,
        <!-- 3 -->remark,
        <!-- 4 -->refer_code,
        <!-- 5 -->refer_id,
        <!-- 6 -->created_time,
        <!-- 7 -->str_list
      )
      values(
        <!-- 0 -->#{id},
        <!-- 1 -->#{costCenter},
        <!-- 2 -->#{costCenterCode},
        <!-- 3 -->#{remark},
        <!-- 4 -->#{referCode},
        <!-- 5 -->#{referId},
        <!-- 6 -->#{createdTime},
        <!-- 7 -->#{strList}
      )
    </insert>


    <insert id="batchInsert">
      insert into wd_abnormal_fines_audit(
          <!-- 0 -->id,
          <!-- 1 -->cost_center,
          <!-- 2 -->cost_center_code,
          <!-- 3 -->remark,
          <!-- 4 -->refer_code,
          <!-- 5 -->refer_id,
          <!-- 6 -->created_time,
          <!-- 7 -->str_list
      )
      SELECT TBL_TEST_SEQ.NEXTVAL,A.* FROM (
      <foreach collection="list" item="item" index="index" separator="union all">
        SELECT
            <!-- 0 -->#{id},
            <!-- 1 -->#{costCenter},
            <!-- 2 -->#{costCenterCode},
            <!-- 3 -->#{remark},
            <!-- 4 -->#{referCode},
            <!-- 5 -->#{referId},
            <!-- 6 -->#{createdTime},
            <!-- 7 -->#{strList}
        FROM DUAL
      </foreach>
      ) A
    </insert>
    <update id="update">
      update TBL_TEST
      <include refid="updateSetSql" />
      where id=#{id} and lock_version=#{lockVersion}
    </update>

    <sql id="updateSetSql">
      <set>
          <if test="id != null">
          <!-- 0 -->id = #{id},
          </if>
          <if test="costCenter != null and costCenter != ''">
          <!-- 1 -->cost_center = #{costCenter},
          </if>
          <if test="costCenterCode != null and costCenterCode != ''">
          <!-- 2 -->cost_center_code = #{costCenterCode},
          </if>
          <if test="remark != null and remark != ''">
          <!-- 3 -->remark = #{remark},
          </if>
          <if test="referCode != null and referCode != ''">
          <!-- 4 -->refer_code = #{referCode},
          </if>
          <if test="referId != null">
          <!-- 5 -->refer_id = #{referId},
          </if>
          <if test="createdTime != null">
          <!-- 6 -->created_time = #{createdTime},
          </if>
          <if test="strList != null and strList.size() > 0">
          <!-- 7 -->str_list = #{strList}
          </if>
      </set>
    </sql>

    <delete>
      delete from TBL_TEST where id = #{id}
    </delete>    <select id="find" resultType="Test">
      select * from TBL_TEST where id = #{id}
    </select>

    <select id="findVo" resultType="TestVo">
      select *
      from TBL_TEST t
      where
      t.id = #{id}
    </select>

    <select id="selectBySo" resultType="Test">
      select t.* from TBL_TEST t
      <include refid="soSqlFilter"/>
    </select>

    <select id="selectVoBySo" resultType="TestVo">
      SELECT *
      FROM TBL_TEST t
      <include refid="soSqlFilter"/>
      order by t.CREATED_TIME desc
    </select>

    <select id="selectCountBySo" resultType="int">
      select count(1) from TBL_TEST t
      <include refid="soSqlFilter"/>
    </select>

    <delete id="deleteByIds" parameterType="map">
      delete from TBL_TEST t where t.id in
      <foreach collection="list" index="dex" item="item" open="("
               close=")" separator=",">
          #{item}
      </foreach>
    </delete>

    <delete id="deleteByIdList">
      delete from TBL_TEST t where t.id in
      <foreach collection="list" index="dex" item="item" open="("
               close=")" separator=",">
          #{item}
      </foreach>
    </delete>

    <select id="selectVoByIdList" resultType="TestVo">
      select *
      from TBL_TEST t
      where t.id in
      <foreach collection="list" index="dex" item="item" open="("
               close=")" separator=",">
          #{item}
      </foreach>
    </select>

    <select id="selectByIdList" resultType="Test">
      select * from TBL_TEST t where t.id in
      <foreach collection="list" index="dex" item="item" open="("
               close=")" separator=",">
          #{item}
      </foreach>
    </select>

    <sql id="soSqlFilter">
      <where>
          <if test="id != null">
            and id = #{id}
          </if>
          <if test="costCenter != null and costCenter != ''">
            and cost_center = #{costCenter}
          </if>
          <if test="costCenterCode != null and costCenterCode != ''">
            and cost_center_code = #{costCenterCode}
          </if>
          <if test="remark != null and remark != ''">
            and remark = #{remark}
          </if>
          <if test="referCode != null and referCode != ''">
            and refer_code = #{referCode}
          </if>
          <if test="referId != null">
            and refer_id = #{referId}
          </if>
          <if test="createdTime != null">
            and created_time = #{createdTime}
          </if>
          <if test="strList != null and strList.size() > 0">
            and str_list = #{strList}
          </if>
      </where>
    </sql>
  <!-- CURD END -->

</mapper>